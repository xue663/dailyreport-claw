<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>APIæµ‹è¯•é¡µé¢</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e2e; color: #cdd6f4; }
        h1 { color: #89b4fa; }
        .section { margin: 20px 0; padding: 15px; background: #313244; border-radius: 8px; }
        .success { color: #a6e3a1; }
        .error { color: #f38ba8; }
        pre { background: #181825; padding: 10px; border-radius: 4px; overflow-x: auto; }
        button { padding: 10px 20px; background: #89b4fa; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #74c7ec; }
    </style>
</head>
<body>
    <h1>ğŸ§ª APIæµ‹è¯•é¡µé¢</h1>
    
    <div class="section">
        <h2>æµ‹è¯•æ­¥éª¤</h2>
        <button onclick="testAPI()">ç‚¹å‡»æµ‹è¯•API</button>
    </div>
    
    <div class="section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="result">ç­‰å¾…æµ‹è¯•...</div>
    </div>
    
    <div class="section">
        <h2>åŸå§‹æ•°æ®</h2>
        <pre id="raw-data">æš‚æ— æ•°æ®</pre>
    </div>

    <script>
        async function testAPI() {
            const resultDiv = document.getElementById('result');
            const rawDiv = document.getElementById('raw-data');
            
            resultDiv.innerHTML = 'â³ æ­£åœ¨æµ‹è¯•...';
            
            try {
                console.log('å¼€å§‹æµ‹è¯•API...');
                console.log('è¯·æ±‚URL: /api/data/today');
                
                const response = await fetch('/api/data/today');
                console.log('å“åº”çŠ¶æ€:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('æ¥æ”¶åˆ°çš„æ•°æ®:', data);
                
                const taskCount = data.tasks ? data.tasks.length : 0;
                const completed = data.stats ? data.stats.completed : 0;
                
                resultDiv.innerHTML = `
                    <p class="success">âœ… APIæµ‹è¯•æˆåŠŸï¼</p>
                    <p>ğŸ“Š ä»»åŠ¡æ•°é‡: ${taskCount}</p>
                    <p>âœ… å®Œæˆæ•°é‡: ${completed}</p>
                `;
                
                rawDiv.textContent = JSON.stringify(data, null, 2);
                
            } catch (error) {
                console.error('æµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `<p class="error">âŒ æµ‹è¯•å¤±è´¥: ${error.message}</p>`;
            }
        }
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨æµ‹è¯•
        window.addEventListener('DOMContentLoaded', () => {
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
            setTimeout(testAPI, 500);
        });
    </script>
</body>
</html>
